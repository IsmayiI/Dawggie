import styles from '../input/Input.module.css'
import { HTMLProps, useState } from "react"


interface PasswordInputProps extends Omit<HTMLProps<HTMLInputElement>, 'type'> {
   isError?: boolean,
   helperText?: string
}

export const PasswordInput = ({ isError = false, helperText, ...props }: PasswordInputProps) => {
   const [showPassword, setShowPassword] = useState(false)

   const showPasswordToggle = props.value

   const inputStyle = `${styles.input} ${isError ? styles.error : ''}`
   const inputType = showPasswordToggle && showPassword ? 'text' : 'password'

   const showSVG = (
      <svg height="16px" width="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
         <path fill-rule="evenodd" clip-rule="evenodd" d="M4.923 6C4.923 4.3 6.301 2.923 8 2.923 9.699 2.923 11.077 4.3 11.077 6 11.077 7.7 9.699 9.077 8 9.077 6.301 9.077 4.923 7.7 4.923 6ZM8 4.154c-1.02 0-1.846.827-1.846 1.846 0 1.02.827 1.846 1.846 1.846 1.02 0 1.846-.827 1.846-1.846 0-1.02-.827-1.846-1.846-1.846Z" fill="black" fill-opacity="0.7" />
         <path fill-rule="evenodd" clip-rule="evenodd" d="M1.701 4.889C1.357 5.385 1.231 5.772 1.231 6c0 .228.126.615.47 1.111.332.478.826.998 1.451 1.478 1.253.961 2.97 1.719 4.847 1.719 1.876 0 3.594-.758 4.847-1.719.625-.48 1.119-.999 1.451-1.478.344-.496.471-.883.471-1.111 0-.228-.127-.615-.471-1.111-.332-.478-.826-.998-1.451-1.478-1.253-.961-2.97-1.719-4.847-1.719-1.876 0-3.594.758-4.847 1.719-.625.48-1.119.999-1.451 1.478ZM2.404 2.435C3.823 1.345 5.798.462 8 .462c2.202 0 4.177.884 5.596 1.974.711.546 1.299 1.155 1.714 1.753.403.582.69 1.22.69 1.813 0 .593-.287 1.231-.691 1.812-.415.598-1.003 1.207-1.714 1.753C12.177 10.655 10.202 11.539 8 11.539c-2.202 0-4.177-.884-5.596-1.974-.711-.546-1.299-1.155-1.714-1.753C.287 7.231 0 6.593 0 6c0-.593.287-1.231.691-1.812.415-.598 1.003-1.207 1.714-1.753Z" fill="black" fill-opacity="0.7" />
      </svg>
   )

   const closeSVG = (
      <svg height="16px" width="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
         <path fill-rule="evenodd" clip-rule="evenodd" d="M15 1.871a.707.707 0 0 0 0-1.001.707.707 0 0 0-1 0L1 14.129a.707.707 0 0 0 1 1L4.207 12.663c1.121.528 2.412.876 3.793.876 2.202 0 4.177-.884 5.597-1.974.711-.546 1.299-1.155 1.714-1.753.403-.581.69-1.219.69-1.812 0-.593-.287-1.231-.691-1.812-.415-.598-1.003-1.207-1.714-1.753-.215-.165-.443-.326-.683-.479L15 1.871ZM12.02 4.85l-1.453 1.453c.322.487.51 1.07.51 1.597 0 1.7-1.378 3.077-3.077 3.077-.627 0-1.21-.188-1.697-.51L5.141 11.73c.874.357 1.843.578 2.859.578 1.876 0 3.594-.758 4.847-1.72.625-.48 1.119-.999 1.451-1.478.344-.495.471-.883.471-1.111 0-.227-.127-.615-.471-1.11-.332-.479-.826-.999-1.451-1.478-.257-.198-.533-.386-.827-.561ZM7.204 9.666c.241.115.511.179.796.179 1.02 0 1.846-.827 1.846-1.846 0-.285-.065-.555-.18-.796L7.204 9.666ZM8 2.462c.821 0 1.611.123 2.352.334.179.051.232.274.101.406l-.607.608c-.062.061-.151.086-.237.067-.517-.117-1.055-.182-1.607-.182-1.876 0-3.594.758-4.847 1.72-.625.48-1.119.999-1.451 1.478-.344.495-.471.883-.471 1.111 0 .227.127.615.471 1.11.283.407.683.844 1.181 1.261.115.097.126.272.019.378l-.518.518a.275.275 0 0 1-.331.03c-.555-.469-1.018-.974-1.363-1.471C.287 9.231 0 8.593 0 8c0-.593.287-1.231.691-1.812C1.105 5.59 1.692 4.981 2.404 4.435 3.824 3.345 5.798 2.462 8 2.462ZM8 4.923c.07 0 .138.003.207.008.197.012.269.246.129.386L7.399 6.254C6.863 6.438 6.438 6.863 6.254 7.399L5.317 8.336c-.14.14-.374.068-.387-.129A3.085 3.085 0 0 1 4.923 8c0-1.7 1.378-3.077 3.077-3.077Z" fill="black" fill-opacity="0.7" />
      </svg>
   )

   return (
      <div className={styles.inputContainer}>
         <input className={inputStyle} type={inputType} {...props} />
         {isError && helperText && <div className={styles.helperText}>{helperText}</div>}
         {showPasswordToggle &&
            <div className={styles.passwordContainer}
               onClick={() => setShowPassword(prev => !prev)}>
               {showPassword ?
                  closeSVG :
                  showSVG}
            </div>}
      </div>
   )
}



